/*!
 * GIT:https://github.com/shrekshrek/css3d-matrix-es6
 * @author: Shrek.wang
 **/

!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i(t.M3D={})}(this,function(t){"use strict";function i(){}function n(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function e(t,i,n){this.x=t||0,this.y=i||0,this.z=n||0}function r(t,i,n,e){this._x=t||0,this._y=i||0,this._z=n||0,this._w=void 0!==e?e:1}function s(t,i,n,e){this._x=t||0,this._y=i||0,this._z=n||0,this._order=e||s.DefaultOrder}function h(){this.elements=[1,0,0,0,1,0,0,0,1]}function o(){this.id=m++,this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=o.DefaultUp.clone(),this.position=new e,this.rotation=new s,this.quaternion=new r,this.scale=new e(1,1,1);var t=this;this.rotation.onChange(function(){t.quaternion.setFromEuler(t.rotation,!1)}),this.quaternion.onChange(function(){t.rotation.setFromQuaternion(t.quaternion,void 0,!1)}),this.modelViewMatrix=new n,this.normalMatrix=new h,this.matrix=new n,this.matrixWorld=new n,this.matrixAutoUpdate=o.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.visible=!0}function a(){o.call(this),this.type="Scene"}function u(t){o.call(this),this.type="Camera",this.matrixWorldInverse=new n,this.fov=void 0!==t?t:50,this.zoom=1}function c(){o.call(this),this.type="Group"}function l(t){o.call(this),this.element=t||document.createElement("div"),this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})}function f(t){l.call(this,t)}Object.assign(i.prototype,{addEventListener:function(t,i){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(i)&&n[t].push(i)},hasEventListener:function(t,i){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(i)},removeEventListener:function(t,i){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var e=n.indexOf(i);-1!==e&&n.splice(e,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var i=this._listeners[t.type];if(void 0!==i){t.target=this;var n=[],e=0,r=i.length;for(e=0;e<r;e++)n[e]=i[e];for(e=0;e<r;e++)n[e].call(this,t)}}}});var y={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,clamp:function(t,i,n){return Math.max(i,Math.min(n,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,n,e,r){return e+(t-i)*(r-e)/(n-i)},lerp:function(t,i,n){return(1-n)*t+n*i},smoothstep:function(t,i,n){return t<=i?0:t>=n?1:(t=(t-i)/(n-i))*t*(3-2*t)},smootherstep:function(t,i,n){return t<=i?0:t>=n?1:(t=(t-i)/(n-i))*t*t*(t*(6*t-15)+10)},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*y.DEG2RAD},radToDeg:function(t){return t*y.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}};Object.assign(n.prototype,{isMatrix4:!0,set:function(t,i,n,e,r,s,h,o,a,u,c,l,f,y,m,x){var d=this.elements;return d[0]=t,d[4]=i,d[8]=n,d[12]=e,d[1]=r,d[5]=s,d[9]=h,d[13]=o,d[2]=a,d[6]=u,d[10]=c,d[14]=l,d[3]=f,d[7]=y,d[11]=m,d[15]=x,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){for(var i=this.elements,n=t.elements,e=0;e<16;e++)i[e]=n[e];return this},copyPosition:function(t){var i=this.elements,n=t.elements;return i[12]=n[12],i[13]=n[13],i[14]=n[14],this},extractBasis:function(t,i,n){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,i,n){return this.set(t.x,i.x,n.x,0,t.y,i.y,n.y,0,t.z,i.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t=new e;return function(i){var n=this.elements,e=i.elements,r=1/t.setFromMatrixColumn(i,0).length(),s=1/t.setFromMatrixColumn(i,1).length(),h=1/t.setFromMatrixColumn(i,2).length();return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[4]=e[4]*s,n[5]=e[5]*s,n[6]=e[6]*s,n[8]=e[8]*h,n[9]=e[9]*h,n[10]=e[10]*h,this}}(),makeRotationFromEuler:function(t){!1===(t&&t.isEuler)&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i=this.elements,n=t.x,e=t.y,r=t.z,s=Math.cos(n),h=Math.sin(n),o=Math.cos(e),a=Math.sin(e),u=Math.cos(r),c=Math.sin(r);if("XYZ"===t.order){var l=s*u,f=s*c,y=h*u,m=h*c;i[0]=o*u,i[4]=-o*c,i[8]=a,i[1]=f+y*a,i[5]=l-m*a,i[9]=-h*o,i[2]=m-l*a,i[6]=y+f*a,i[10]=s*o}else if("YXZ"===t.order){var x=o*u,d=o*c,_=a*u,p=a*c;i[0]=x+p*h,i[4]=_*h-d,i[8]=s*a,i[1]=s*c,i[5]=s*u,i[9]=-h,i[2]=d*h-_,i[6]=p+x*h,i[10]=s*o}else if("ZXY"===t.order){x=o*u,d=o*c,_=a*u,p=a*c;i[0]=x-p*h,i[4]=-s*c,i[8]=_+d*h,i[1]=d+_*h,i[5]=s*u,i[9]=p-x*h,i[2]=-s*a,i[6]=h,i[10]=s*o}else if("ZYX"===t.order){l=s*u,f=s*c,y=h*u,m=h*c;i[0]=o*u,i[4]=y*a-f,i[8]=l*a+m,i[1]=o*c,i[5]=m*a+l,i[9]=f*a-y,i[2]=-a,i[6]=h*o,i[10]=s*o}else if("YZX"===t.order){var v=s*o,z=s*a,M=h*o,g=h*a;i[0]=o*u,i[4]=g-v*c,i[8]=M*c+z,i[1]=c,i[5]=s*u,i[9]=-h*u,i[2]=-a*u,i[6]=z*c+M,i[10]=v-g*c}else if("XZY"===t.order){v=s*o,z=s*a,M=h*o,g=h*a;i[0]=o*u,i[4]=-c,i[8]=a*u,i[1]=v*c+g,i[5]=s*u,i[9]=z*c-M,i[2]=M*c-z,i[6]=h*u,i[10]=g*c+v}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromQuaternion:function(t){var i=this.elements,n=t.x,e=t.y,r=t.z,s=t.w,h=n+n,o=e+e,a=r+r,u=n*h,c=n*o,l=n*a,f=e*o,y=e*a,m=r*a,x=s*h,d=s*o,_=s*a;return i[0]=1-(f+m),i[4]=c-_,i[8]=l+d,i[1]=c+_,i[5]=1-(u+m),i[9]=y-x,i[2]=l-d,i[6]=y+x,i[10]=1-(u+f),i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},lookAt:function(){var t=new e,i=new e,n=new e;return function(e,r,s){var h=this.elements;return n.subVectors(e,r).normalize(),0===n.lengthSq()&&(n.z=1),t.crossVectors(s,n).normalize(),0===t.lengthSq()&&(n.z+=1e-4,t.crossVectors(s,n).normalize()),i.crossVectors(n,t),h[0]=t.x,h[4]=i.x,h[8]=n.x,h[1]=t.y,h[5]=i.y,h[9]=n.y,h[2]=t.z,h[6]=i.z,h[10]=n.z,this}}(),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,i){var n=t.elements,e=i.elements,r=this.elements,s=n[0],h=n[4],o=n[8],a=n[12],u=n[1],c=n[5],l=n[9],f=n[13],y=n[2],m=n[6],x=n[10],d=n[14],_=n[3],p=n[7],v=n[11],z=n[15],M=e[0],g=e[4],w=e[8],b=e[12],C=e[1],O=e[5],E=e[9],F=e[13],A=e[2],k=e[6],j=e[10],S=e[14],R=e[3],W=e[7],q=e[11],D=e[15];return r[0]=s*M+h*C+o*A+a*R,r[4]=s*g+h*O+o*k+a*W,r[8]=s*w+h*E+o*j+a*q,r[12]=s*b+h*F+o*S+a*D,r[1]=u*M+c*C+l*A+f*R,r[5]=u*g+c*O+l*k+f*W,r[9]=u*w+c*E+l*j+f*q,r[13]=u*b+c*F+l*S+f*D,r[2]=y*M+m*C+x*A+d*R,r[6]=y*g+m*O+x*k+d*W,r[10]=y*w+m*E+x*j+d*q,r[14]=y*b+m*F+x*S+d*D,r[3]=_*M+p*C+v*A+z*R,r[7]=_*g+p*O+v*k+z*W,r[11]=_*w+p*E+v*j+z*q,r[15]=_*b+p*F+v*S+z*D,this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this},determinant:function(){var t=this.elements,i=t[0],n=t[4],e=t[8],r=t[12],s=t[1],h=t[5],o=t[9],a=t[13],u=t[2],c=t[6],l=t[10],f=t[14];return t[3]*(+r*o*c-e*a*c-r*h*l+n*a*l+e*h*f-n*o*f)+t[7]*(+i*o*f-i*a*l+r*s*l-e*s*f+e*a*u-r*o*u)+t[11]*(+i*a*c-i*h*f-r*s*c+n*s*f+r*h*u-n*a*u)+t[15]*(-e*h*u-i*o*c+i*h*l+e*s*c-n*s*l+n*o*u)},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[4],i[4]=t,t=i[2],i[2]=i[8],i[8]=t,t=i[6],i[6]=i[9],i[9]=t,t=i[3],i[3]=i[12],i[12]=t,t=i[7],i[7]=i[13],i[13]=t,t=i[11],i[11]=i[14],i[14]=t,this},setPosition:function(t){var i=this.elements;return i[12]=t.x,i[13]=t.y,i[14]=t.z,this},getInverse:function(t){var i=this.elements,n=t.elements,e=n[0],r=n[1],s=n[2],h=n[3],o=n[4],a=n[5],u=n[6],c=n[7],l=n[8],f=n[9],y=n[10],m=n[11],x=n[12],d=n[13],_=n[14],p=n[15],v=f*_*c-d*y*c+d*u*m-a*_*m-f*u*p+a*y*p,z=x*y*c-l*_*c-x*u*m+o*_*m+l*u*p-o*y*p,M=l*d*c-x*f*c+x*a*m-o*d*m-l*a*p+o*f*p,g=x*f*u-l*d*u-x*a*y+o*d*y+l*a*_-o*f*_,w=e*v+r*z+s*M+h*g;if(0===w)return this.identity();var b=1/w;return i[0]=v*b,i[1]=(d*y*h-f*_*h-d*s*m+r*_*m+f*s*p-r*y*p)*b,i[2]=(a*_*h-d*u*h+d*s*c-r*_*c-a*s*p+r*u*p)*b,i[3]=(f*u*h-a*y*h-f*s*c+r*y*c+a*s*m-r*u*m)*b,i[4]=z*b,i[5]=(l*_*h-x*y*h+x*s*m-e*_*m-l*s*p+e*y*p)*b,i[6]=(x*u*h-o*_*h-x*s*c+e*_*c+o*s*p-e*u*p)*b,i[7]=(o*y*h-l*u*h+l*s*c-e*y*c-o*s*m+e*u*m)*b,i[8]=M*b,i[9]=(x*f*h-l*d*h-x*r*m+e*d*m+l*r*p-e*f*p)*b,i[10]=(o*d*h-x*a*h+x*r*c-e*d*c-o*r*p+e*a*p)*b,i[11]=(l*a*h-o*f*h-l*r*c+e*f*c+o*r*m-e*a*m)*b,i[12]=g*b,i[13]=(l*d*s-x*f*s+x*r*y-e*d*y-l*r*_+e*f*_)*b,i[14]=(x*a*s-o*d*s-x*r*u+e*d*u+o*r*_-e*a*_)*b,i[15]=(o*f*s-l*a*s+l*r*u-e*f*u-o*r*y+e*a*y)*b,this},scale:function(t){var i=this.elements,n=t.x,e=t.y,r=t.z;return i[0]*=n,i[4]*=e,i[8]*=r,i[1]*=n,i[5]*=e,i[9]*=r,i[2]*=n,i[6]*=e,i[10]*=r,i[3]*=n,i[7]*=e,i[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],e=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,n,e))},makeTranslation:function(t,i,n){return this.set(1,0,0,t,0,1,0,i,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var i=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1),this},makeRotationY:function(t){var i=Math.cos(t),n=Math.sin(t);return this.set(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1),this},makeRotationZ:function(t){var i=Math.cos(t),n=Math.sin(t);return this.set(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,i){var n=Math.cos(i),e=Math.sin(i),r=1-n,s=t.x,h=t.y,o=t.z,a=r*s,u=r*h;return this.set(a*s+n,a*h-e*o,a*o+e*h,0,a*h+e*o,u*h+n,u*o-e*s,0,a*o-e*h,u*o+e*s,r*o*o+n,0,0,0,0,1),this},makeScale:function(t,i,n){return this.set(t,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,i,n){return this.set(1,i,n,0,t,1,n,0,t,i,1,0,0,0,0,1),this},compose:function(t,i,n){return this.makeRotationFromQuaternion(i),this.scale(n),this.setPosition(t),this},decompose:function(){var t=new e,i=new n;return function(n,e,r){var s=this.elements,h=t.set(s[0],s[1],s[2]).length(),o=t.set(s[4],s[5],s[6]).length(),a=t.set(s[8],s[9],s[10]).length();this.determinant()<0&&(h=-h),n.x=s[12],n.y=s[13],n.z=s[14];for(var u=0;u<16;u++)i.elements[u]=this.elements[u];var c=1/h,l=1/o,f=1/a;return i.elements[0]*=c,i.elements[1]*=c,i.elements[2]*=c,i.elements[4]*=l,i.elements[5]*=l,i.elements[6]*=l,i.elements[8]*=f,i.elements[9]*=f,i.elements[10]*=f,e.setFromRotationMatrix(i),r.x=h,r.y=o,r.z=a,this}}(),makePerspective:function(t,i,n,e,r,s){var h=this.elements,o=2*r/(i-t),a=2*r/(n-e),u=(i+t)/(i-t),c=(n+e)/(n-e),l=-(s+r)/(s-r),f=-2*s*r/(s-r);return h[0]=o,h[4]=0,h[8]=u,h[12]=0,h[1]=0,h[5]=a,h[9]=c,h[13]=0,h[2]=0,h[6]=0,h[10]=l,h[14]=f,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this},makeOrthographic:function(t,i,n,e,r,s){var h=this.elements,o=1/(i-t),a=1/(n-e),u=1/(s-r),c=(i+t)*o,l=(n+e)*a,f=(s+r)*u;return h[0]=2*o,h[4]=0,h[8]=0,h[12]=-c,h[1]=0,h[5]=2*a,h[9]=0,h[13]=-l,h[2]=0,h[6]=0,h[10]=-2*u,h[14]=-f,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this},equals:function(t){for(var i=this.elements,n=t.elements,e=0;e<16;e++)if(i[e]!==n[e])return!1;return!0},fromArray:function(t,i){void 0===i&&(i=0);for(var n=0;n<16;n++)this.elements[n]=t[n+i];return this},toArray:function(t,i){void 0===t&&(t=[]),void 0===i&&(i=0);var n=this.elements;return t[i]=n[0],t[i+1]=n[1],t[i+2]=n[2],t[i+3]=n[3],t[i+4]=n[4],t[i+5]=n[5],t[i+6]=n[6],t[i+7]=n[7],t[i+8]=n[8],t[i+9]=n[9],t[i+10]=n[10],t[i+11]=n[11],t[i+12]=n[12],t[i+13]=n[13],t[i+14]=n[14],t[i+15]=n[15],t}}),Object.assign(e.prototype,{isVector3:!0,set:function(t,i,n){return this.x=t||0,this.y=i||this.x,this.z=n||this.x,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this},sub:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},divideVectors:function(t,i){return this.x=t.x/i.x,this.y=t.y/i.y,this.z=t.z/i.z,this},applyEuler:function(){var t=new r;return function(i){return!1===(i&&i.isEuler)&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t.setFromEuler(i))}}(),applyAxisAngle:function(){var t=new r;return function(i,n){return this.applyQuaternion(t.setFromAxisAngle(i,n))}}(),applyMatrix3:function(t){var i=this.x,n=this.y,e=this.z,r=t.elements;return this.x=r[0]*i+r[3]*n+r[6]*e,this.y=r[1]*i+r[4]*n+r[7]*e,this.z=r[2]*i+r[5]*n+r[8]*e,this},applyMatrix4:function(t){var i=this.x,n=this.y,e=this.z,r=t.elements;this.x=r[0]*i+r[4]*n+r[8]*e+r[12],this.y=r[1]*i+r[5]*n+r[9]*e+r[13],this.z=r[2]*i+r[6]*n+r[10]*e+r[14];var s=r[3]*i+r[7]*n+r[11]*e+r[15];return this.divideScalar(s)},applyQuaternion:function(t){var i=this.x,n=this.y,e=this.z,r=t.x,s=t.y,h=t.z,o=t.w,a=o*i+s*e-h*n,u=o*n+h*i-r*e,c=o*e+r*n-s*i,l=-r*i-s*n-h*e;return this.x=a*o+l*-r+u*-h-c*-s,this.y=u*o+l*-s+c*-r-a*-h,this.z=c*o+l*-h+a*-s-u*-r,this},transformDirection:function(t){var i=this.x,n=this.y,e=this.z,r=t.elements;return this.x=r[0]*i+r[4]*n+r[8]*e,this.y=r[1]*i+r[5]*n+r[9]*e,this.z=r[2]*i+r[6]*n+r[10]*e,this.normalize()},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this},clampScalar:function(){var t=new e,i=new e;return function(n,e){return t.set(n,n,n),i.set(e,e,e),this.clamp(t,i)}}(),clampLength:function(t,i){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(i,n))/n)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.lengthSq())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this},lerpVectors:function(t,i,n){return this.subVectors(i,t).multiplyScalar(n).add(t)},normalize:function(){return this.divideScalar(this.length())},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},dotVectors:function(t,i){var n=t.x,e=t.y,r=t.z;return n*i.x+e*i.y+r*i.z},cross:function(t){var i=this.x,n=this.y,e=this.z;return this.x=n*t.z-e*t.y,this.y=e*t.x-i*t.z,this.z=i*t.y-n*t.x,this},crossVectors:function(t,i){var n=t.x,e=t.y,r=t.z,s=i.x,h=i.y,o=i.z;return this.x=e*o-r*h,this.y=r*s-n*o,this.z=n*h-e*s,this},projectOnVector:function(t){var i=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(i)},projectOnPlane:function(){var t=new e;return function(i){return t.copy(this).projectOnVector(i),this.sub(t)}}(),reflect:function(){var t=new e;return function(i){return this.sub(t.copy(i).multiplyScalar(2*this.dot(i)))}}(),angleTo:function(t){var i=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(y.clamp(i,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,n=this.y-t.y,e=this.z-t.z;return i*i+n*n+e*e},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var i=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),e=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=n,this.z=e,this},setFromMatrixColumn:function(t,i){return this.fromArray(t.elements,4*i)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this.z=t[i+2],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t}}),Object.assign(r,{slerp:function(t,i,n,e){return n.copy(t).slerp(i,e)},slerpFlat:function(t,i,n,e,r,s,h){var o=n[e+0],a=n[e+1],u=n[e+2],c=n[e+3],l=r[s+0],f=r[s+1],y=r[s+2],m=r[s+3];if(c!==m||o!==l||a!==f||u!==y){var x=1-h,d=o*l+a*f+u*y+c*m,_=d>=0?1:-1,p=1-d*d;if(p>Number.EPSILON){var v=Math.sqrt(p),z=Math.atan2(v,d*_);x=Math.sin(x*z)/v,h=Math.sin(h*z)/v}var M=h*_;if(o=o*x+l*M,a=a*x+f*M,u=u*x+y*M,c=c*x+m*M,x===1-h){var g=1/Math.sqrt(o*o+a*a+u*u+c*c);o*=g,a*=g,u*=g,c*=g}}t[i]=o,t[i+1]=a,t[i+2]=u,t[i+3]=c}}),Object.defineProperties(r.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(r.prototype,{isQuaternion:!0,set:function(t,i,n,e){return this._x=t,this._y=i,this._z=n,this._w=e,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,i){if(!1===(t&&t.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,e=t._y,r=t._z,s=t.order,h=Math.cos,o=Math.sin,a=h(n/2),u=h(e/2),c=h(r/2),l=o(n/2),f=o(e/2),y=o(r/2);return"XYZ"===s?(this._x=l*u*c+a*f*y,this._y=a*f*c-l*u*y,this._z=a*u*y+l*f*c,this._w=a*u*c-l*f*y):"YXZ"===s?(this._x=l*u*c+a*f*y,this._y=a*f*c-l*u*y,this._z=a*u*y-l*f*c,this._w=a*u*c+l*f*y):"ZXY"===s?(this._x=l*u*c-a*f*y,this._y=a*f*c+l*u*y,this._z=a*u*y+l*f*c,this._w=a*u*c-l*f*y):"ZYX"===s?(this._x=l*u*c-a*f*y,this._y=a*f*c+l*u*y,this._z=a*u*y-l*f*c,this._w=a*u*c+l*f*y):"YZX"===s?(this._x=l*u*c+a*f*y,this._y=a*f*c+l*u*y,this._z=a*u*y-l*f*c,this._w=a*u*c-l*f*y):"XZY"===s&&(this._x=l*u*c-a*f*y,this._y=a*f*c-l*u*y,this._z=a*u*y+l*f*c,this._w=a*u*c+l*f*y),!1!==i&&this.onChangeCallback(),this},setFromAxisAngle:function(t,i){var n=i/2,e=Math.sin(n);return this._x=t.x*e,this._y=t.y*e,this._z=t.z*e,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var i,n=t.elements,e=n[0],r=n[4],s=n[8],h=n[1],o=n[5],a=n[9],u=n[2],c=n[6],l=n[10],f=e+o+l;return f>0?(i=.5/Math.sqrt(f+1),this._w=.25/i,this._x=(c-a)*i,this._y=(s-u)*i,this._z=(h-r)*i):e>o&&e>l?(i=2*Math.sqrt(1+e-o-l),this._w=(c-a)/i,this._x=.25*i,this._y=(r+h)/i,this._z=(s+u)/i):o>l?(i=2*Math.sqrt(1+o-e-l),this._w=(s-u)/i,this._x=(r+h)/i,this._y=.25*i,this._z=(a+c)/i):(i=2*Math.sqrt(1+l-e-o),this._w=(h-r)/i,this._x=(s+u)/i,this._y=(a+c)/i,this._z=.25*i),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,i=new e;return function(n,r){return void 0===i&&(i=new e),(t=n.dot(r)+1)<1e-6?(t=0,Math.abs(n.x)>Math.abs(n.z)?i.set(-n.y,n.x,0):i.set(0,-n.z,n.y)):i.crossVectors(n,r),this._x=i.x,this._y=i.y,this._z=i.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t){return this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,i){var n=t._x,e=t._y,r=t._z,s=t._w,h=i._x,o=i._y,a=i._z,u=i._w;return this._x=n*u+s*h+e*a-r*o,this._y=e*u+s*o+r*h-n*a,this._z=r*u+s*a+n*o-e*h,this._w=s*u-n*h-e*o-r*a,this.onChangeCallback(),this},slerp:function(t,i){if(0===i)return this;if(1===i)return this.copy(t);var n=this._x,e=this._y,r=this._z,s=this._w,h=s*t._w+n*t._x+e*t._y+r*t._z;if(h<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,h=-h):this.copy(t),h>=1)return this._w=s,this._x=n,this._y=e,this._z=r,this;var o=Math.sqrt(1-h*h);if(Math.abs(o)<.001)return this._w=.5*(s+this._w),this._x=.5*(n+this._x),this._y=.5*(e+this._y),this._z=.5*(r+this._z),this;var a=Math.atan2(o,h),u=Math.sin((1-i)*a)/o,c=Math.sin(i*a)/o;return this._w=s*u+this._w*c,this._x=n*u+this._x*c,this._y=e*u+this._y*c,this._z=r*u+this._z*c,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,i){return void 0===i&&(i=0),this._x=t[i],this._y=t[i+1],this._z=t[i+2],this._w=t[i+3],this.onChangeCallback(),this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),s.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],s.DefaultOrder="XYZ",Object.defineProperties(s.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(s.prototype,{isEuler:!0,set:function(t,i,n,e){return this._x=t,this._y=i,this._z=n,this._order=e||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,i,n){var e=y.clamp,r=t.elements,s=r[0],h=r[4],o=r[8],a=r[1],u=r[5],c=r[9],l=r[2],f=r[6],m=r[10];return"XYZ"===(i=i||this._order)?(this._y=Math.asin(e(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(-c,m),this._z=Math.atan2(-h,s)):(this._x=Math.atan2(f,u),this._z=0)):"YXZ"===i?(this._x=Math.asin(-e(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(o,m),this._z=Math.atan2(a,u)):(this._y=Math.atan2(-l,s),this._z=0)):"ZXY"===i?(this._x=Math.asin(e(f,-1,1)),Math.abs(f)<.99999?(this._y=Math.atan2(-l,m),this._z=Math.atan2(-h,u)):(this._y=0,this._z=Math.atan2(a,s))):"ZYX"===i?(this._y=Math.asin(-e(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(f,m),this._z=Math.atan2(a,s)):(this._x=0,this._z=Math.atan2(-h,u))):"YZX"===i?(this._z=Math.asin(e(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-l,s)):(this._x=0,this._y=Math.atan2(o,m))):"XZY"===i?(this._z=Math.asin(-e(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(f,u),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-c,m),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+i),this._order=i,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new n;return function(i,n,e){return t.makeRotationFromQuaternion(i),this.setFromRotationMatrix(t,n,e)}}(),setFromVector3:function(t,i){return this.set(t.x,t.y,t.z,i||this._order)},reorder:function(){var t=new r;return function(i){return t.setFromEuler(this),this.setFromQuaternion(t,i)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new e(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(h.prototype,{isMatrix3:!0,set:function(t,i,n,e,r,s,h,o,a){var u=this.elements;return u[0]=t,u[3]=i,u[6]=n,u[1]=e,u[4]=r,u[7]=s,u[2]=h,u[5]=o,u[8]=a,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){for(var i=this.elements,n=t.elements,e=0;e<9;e++)i[e]=n[e];return this},setFromMatrix4:function(t){var i=t.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this},determinant:function(){var t=this.elements,i=t[0],n=t[1],e=t[2],r=t[3],s=t[4],h=t[5],o=t[6],a=t[7],u=t[8];return i*s*u-i*h*a-n*r*u+n*h*o+e*r*a-e*s*o},getInverse:function(t){var i=t.elements,n=this.elements,e=i[0],r=i[1],s=i[2],h=i[3],o=i[4],a=i[5],u=i[6],c=i[7],l=i[8],f=l*o-a*c,y=a*u-l*h,m=c*h-o*u,x=e*f+r*y+s*m;if(0===x)return this.identity();var d=1/x;return n[0]=f*d,n[1]=(s*c-l*r)*d,n[2]=(a*r-s*o)*d,n[3]=y*d,n[4]=(l*e-s*u)*d,n[5]=(s*h-a*e)*d,n[6]=m*d,n[7]=(r*u-c*e)*d,n[8]=(o*e-r*h)*d,this},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[3],i[3]=t,t=i[2],i[2]=i[6],i[6]=t,t=i[5],i[5]=i[7],i[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},fromArray:function(t,i){void 0===i&&(i=0);for(var n=0;n<9;n++)this.elements[n]=t[n+i];return this},toArray:function(t,i){void 0===t&&(t=[]),void 0===i&&(i=0);var n=this.elements;return t[i]=n[0],t[i+1]=n[1],t[i+2]=n[2],t[i+3]=n[3],t[i+4]=n[4],t[i+5]=n[5],t[i+6]=n[6],t[i+7]=n[7],t[i+8]=n[8],t}});var m=0;o.DefaultUp=new e(0,1,0),o.DefaultMatrixAutoUpdate=!0,Object.assign(o.prototype,i.prototype,{isObject3D:!0,applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix)},setRotationFromAxisAngle:function(t,i){this.quaternion.setFromAxisAngle(t,i)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new r;return function(i,n){return t.setFromAxisAngle(i,n),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new e(1,0,0);return function(i){return this.rotateOnAxis(t,i)}}(),rotateY:function(){var t=new e(0,1,0);return function(i){return this.rotateOnAxis(t,i)}}(),rotateZ:function(){var t=new e(0,0,1);return function(i){return this.rotateOnAxis(t,i)}}(),translateOnAxis:function(){var t=new e;return function(i,n){return t.copy(i).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new e(1,0,0);return function(i){return this.translateOnAxis(t,i)}}(),translateY:function(){var t=new e(0,1,0);return function(i){return this.translateOnAxis(t,i)}}(),translateZ:function(){var t=new e(0,0,1);return function(i){return this.translateOnAxis(t,i)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new n;return function(i){return i.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new n;return function(i){0!==this.position.distanceToSquared(i)?(this.isCamera?t.lookAt(this.position,i,this.up):t.lookAt(i,this.position,this.up),this.quaternion.setFromRotationMatrix(t)):console.warn("THREE.Object3D.lookAt(): target vector is the same as object position.")}}(),add:function(t){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1)for(var i=0;i<arguments.length;i++)this.remove(arguments[i]);var n=this.children.indexOf(t);-1!==n&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(n,1))},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,i){if(this[t]===i)return this;for(var n=0,e=this.children.length;n<e;n++){var r=this.children[n].getObjectByProperty(t,i);if(void 0!==r)return r}},getWorldPosition:function(t){var i=t||new e;return this.updateMatrixWorld(!0),i.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new e,i=new e;return function(n){var e=n||new r;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,i),e}}(),getWorldRotation:function(){var t=new r;return function(i){var n=i||new s;return this.getWorldQuaternion(t),n.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new e,i=new r;return function(n){var r=n||new e;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,i,r),r}}(),getWorldDirection:function(){var t=new r;return function(i){var n=i||new e;return this.getWorldQuaternion(t),n.set(0,0,1).applyQuaternion(t)}}(),traverse:function(t){t(this);for(var i=this.children,n=0,e=i.length;n<e;n++)i[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var i=this.children,n=0,e=i.length;n<e;n++)i[n].traverseVisible(t)}},traverseAncestors:function(t){var i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var i=this.children,n=0,e=i.length;n<e;n++)i[n].updateMatrixWorld(t)}}),a.prototype=Object.assign(Object.create(o.prototype),{constructor:a}),u.prototype=Object.assign(Object.create(o.prototype),{constructor:u,isCamera:!0,getEffectiveFOV:function(){return 2*y.RAD2DEG*Math.atan(Math.tan(.5*y.DEG2RAD*this.fov)/this.zoom)}}),c.prototype=Object.assign(Object.create(o.prototype),{constructor:c}),l.prototype=Object.assign(Object.create(o.prototype),{constructor:l,isCssObject:!0}),f.prototype=Object.assign(Object.create(l.prototype),{constructor:f,isCssSprite:!0}),t.EventDispatcher=i,t.Object3D=o,t.Scene=a,t.Camera=u,t.Group=c,t.Math=y,t.Euler=s,t.Matrix3=h,t.Matrix4=n,t.Quaternion=r,t.Vector3=e,t.CssSprite=f,t.CssObject=l,t.CssRenderer=function(){function t(t){return Math.abs(t)<Number.EPSILON?0:t}function i(i){var n=i.elements;return"translate3d(-50%,-50%,0) matrix3d("+t(n[0])+","+t(n[1])+","+t(n[2])+","+t(n[3])+","+t(-n[4])+","+t(-n[5])+","+t(-n[6])+","+t(-n[7])+","+t(n[8])+","+t(n[9])+","+t(n[10])+","+t(n[11])+","+t(n[12])+","+t(n[13])+","+t(n[14])+","+t(n[15])+")"}function e(t,n){if(t instanceof l){var r;t instanceof f?(h.copy(n.matrixWorld),h.copyPosition(t.matrixWorld),h.scale(t.scale),h.elements[3]=0,h.elements[7]=0,h.elements[11]=0,h.elements[15]=1,r=i(h)):r=i(t.matrixWorld);var s=t.element,a=o.objects[t.id];void 0!==a&&a===r||(s.style.WebkitTransform=r,s.style.transform=r,o.objects[t.id]=r),s.parentNode!==u&&u.appendChild(s)}for(var c=0,y=t.children.length;c<y;c++)e(t.children[c],n)}var r,s,h=new n,o={camera:{fov:0,style:""},objects:{}},a=document.createElement("div");a.style.overflow="hidden",a.style.WebkitTransformStyle="preserve-3d",a.style.transformStyle="preserve-3d",this.domElement=a;var u=document.createElement("div");u.style.position="absolute",u.style.left="50%",u.style.top="50%",u.style.WebkitTransformStyle="preserve-3d",u.style.transformStyle="preserve-3d",a.appendChild(u),this.setClearColor=function(){},this.getSize=function(){return{width:r,height:s}},this.setSize=function(t,i){r=t,s=i,a.style.width=t+"px",a.style.height=i+"px"},this.render=function(i,n){var r=.5/Math.tan(y.degToRad(.5*n.getEffectiveFOV()))*s;o.camera.fov!==r&&(a.style.WebkitPerspective=r+"px",a.style.perspective=r+"px",o.camera.fov=r),i.updateMatrixWorld(),null===n.parent&&n.updateMatrixWorld(),n.matrixWorldInverse.getInverse(n.matrixWorld);var h="translateZ("+r+"px)"+function(i){var n=i.elements;return"matrix3d("+t(n[0])+","+t(-n[1])+","+t(n[2])+","+t(n[3])+","+t(n[4])+","+t(-n[5])+","+t(n[6])+","+t(n[7])+","+t(n[8])+","+t(-n[9])+","+t(n[10])+","+t(n[11])+","+t(n[12])+","+t(-n[13])+","+t(n[14])+","+t(n[15])+")"}(n.matrixWorldInverse);o.camera.style!==h&&(u.style.WebkitTransform=h,u.style.transform=h,o.camera.style=h),e(i,n)}},Object.defineProperty(t,"__esModule",{value:!0})});
